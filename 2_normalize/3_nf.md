# 第 3 正規形

## 第 3 正規形とは？

- すべての非キー属性が候補キーに推移的に関数従属しない関数

### 第 3 正規形の定義

- 関係 R が第３正規形（the third normal form, 3NF）であるとは、次の 2 つの条件を満たすときをいう

  1. R は第２正規形である

  2. R のすべての**非キー属性**は R の**いかなる候補キーにも推移的に関数従属しない**

## 第 3 正規形にする方法は？

- 候補キー以外の属性または属性の組に従属する推移的関数従属性を排除する

- 正規化の手順

  1. 関係（リレーション）が推移的関数従属性の条件を満たしているかどうかを確認する

  2. 推移的関数従属性のうち、「Y→Z」を別関係（リレーション）に移し、推移的関数従属性を排除する

## 推移的関数従属性とは？

- 関係 R の異なる属性または属性の集合である X, Y, Z について、「X→Y が成立すること」「Y→X が成立しないこと」「Y→Z が成立すること」の 3 つの制約が成立している関数従属性のこと

- 「X が決まると Y が決まる」「Y が決まると X に関係なく Z が決まる」「Y が決まっても X は決まらない」

<img width="450" alt="スクリーンショット 2024-04-29 13 31 30" src="https://github.com/kashi-iyo/database_specialist/assets/54946329/fde1482e-8b0e-4585-b00b-e032d5614adf">


## 推移的関数従属性を排除する方法

- X→Y→Z の関係において、Y→Z を別の関係にする

- Y は元の関係にも外部キーとして残しておく

## 外部キーとは？

- 複数の関係を結びつけるためのキー

## 外部キーに関する注意点

- どちらか一方のリレーションに勝手にデータを登録してはならない

- 元のリレーションにあるタプルを、分割後のリレーション側で削除することは基本的にできない。データに矛盾が生じるため

  - ただ、候補キー側の情報を削除したときに、対応する外部キーのタプルを一緒に削除する方法がある

## 候補キー側の情報を削除したときに、対応する外部キーのタプルを一緒に削除する方法は？

- カスケード（CASCADE）

## 互いの関係（リレーション）の間にある外部キーによる制約をなんという？

- 参照制約（または外部キー制約）
